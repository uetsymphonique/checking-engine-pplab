---

- id: 6469befa-748a-4b9c-a96d-f191fde47d89
  name: Create staging directory
  description: create a directory for exfil staging
  tactic: collection
  technique:
    attack_id: T1074.001
    name: "Data Staged: Local Data Staging"
  platforms:
    darwin:
      sh:
        command: |
          mkdir -p staged && echo $PWD/staged
        cleanup: |
          rm -rf staged
        parsers:
          plugins.stockpile.app.parsers.basic:
            - source: host.dir.staged
    linux:
      sh:
        command: |
          mkdir -p staged && echo $PWD/staged
        cleanup: |
          rm -rf staged
        parsers:
          plugins.stockpile.app.parsers.basic:
            - source: host.dir.staged
    windows:
      psh,pwsh:
        command: |
          New-Item -Path "." -Name "staged" -ItemType "directory" -Force | foreach {$_.FullName} | Select-Object
        cleanup: |
          Remove-Item -Path "staged" -recurse
        parsers:
          plugins.stockpile.app.parsers.basic:
            - source: host.dir.staged
  
  detections:
  - detection_type: api
    detection_platform: cym
    detection_config:
      command: 'detection query go here'
      jitter: 900
      before_reported_time: 900
      after_reported_time: 900
      delay: 300
    max_retries: 10
  - detection_type: linux
    detection_platform: sh
    detection_config:
      command: 'recheck_command_go_here'
      timeout: 300
      delay: 300
    max_retries: 10
  - detection_type: windows
    detection_platform: psh
    detection_config:
      command: 'recheck_command_go_here'
      timeout: 300
      delay: 300
    max_retries: 10
  - detection_type: api
    detection_platform: apitest
    detection_config:
      command: 'detection query for T1074.001 go here'
      jitter: 9
      before_reported_time: 900
      after_reported_time: 900
      delay: 3
    max_retries: 3
  - detection_type: linux
    detection_platform: agenttest
    detection_config:
      command: 'detection query go here'
      jitter: 900
      before_reported_time: 900
      after_reported_time: 900
      delay: 300
    max_retries: 10